{% extends "base.html" %}

{% block head %}

<script type="text/javascript">
function Match(hero, match_id){
    var self = this;
    self.hero = hero;
    self.match_id = match_id;
}

var myModel = {
    self: this,
//    name: ko.observable('Jensa'),
//    age: ko.observable(28),
    //match_id: ko.observable(''),
    row_data: ko.observableArray([]), 
    matches:  ko.observableArray([
    ]),

    addRow : function(data) {
        this.matches.push(new Match(data.summary, data.match_id));
    },

    //increment : function() {
        //var prevage = this.age();
        //this.age(prevage + 1);
    //}
};
$(function(){
    ko.applyBindings(myModel);
});

var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};

$(function() {
    $('button#load_games').bind('click', function() {
        $.getJSON($SCRIPT_ROOT + '/_load_games', {
            hero_name: $('select[name="hero"]').val()
            }, function(data) {
            var d = data.matches;
            self.myModel.matches([]);
            for(var i = 0; i < d.length; i++){
                self.myModel.addRow(d[i]);
            }
        });
        return false;
    });
});

$(function() {
    $('button#scrape_match').bind('click', function() {
        $.getJSON($SCRIPT_ROOT + '/_scrape_game', {
            match_id: $('input[name="match_id_input"]').val()//'67601693'
            }, function(data) {
        });
        return false;
    });
});

</script>

{% endblock %}

{% block body %}
<input name="match_id_input"></input>
<button css="btn" id="scrape_match">Scrape match</button>
<br/><br/>
<div class="container" style="background-color: #FCF3FF">
<div class="row">
    <div class="span4">
<select name="hero">
    <option value="Lina">Lina</option>
    <option value="Pugna">Pugna</option>
    <option value="Sven">Sven</option>
    <option value="Templar Assassin">Templar Assassin</option>
</select>
</div><div class="span4">

<button id="load_games" class="btn btn-primary">Load games</button>
</div>
<table class="table">
    <thead>
        <tr class='row'>
            <th class='span4'>Hero</th>
            <th class='span4'>Match ID</th> 
        </tr>
    </thead>
    <tbody data-bind="foreach: matches">
        <tr class='row'>
            <td class='span4' data-bind="text: hero"></td>
            <td class='span4' data-bind="text: match_id"></td>
        </tr>
    </tbody>
</table>
</div>


{% endblock %}
